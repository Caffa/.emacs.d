#!/usr/bin/env ruby

load File.dirname(__FILE__) + "/elpa_update.rb"  
require 'optparse'


option_parser = OptionParser.new do |opts|
  
  elpa = EmacsElpa::Packages::GitCommitter.new()
  opts.banner = "Usage: git-elpa [options]"

  opts.on "-l", "--list", "List updated packages" do 
    puts "Updated ELPA packages...", ""
    puts elpa.updated_packages
    exit 0
  end
  
  opts.on "-cPACKAGE", "--commit=PACKAGE", "Commit a new/updated elpa package" do |package|    
    elpa.commit_package package
    exit 0
  end

  opts.on "-A", "--all", "Commit all updated elpa packages" do
    puts <<-EOD.gsub(/^ */,"")
        Commit all updated packages

        Current commit (for reset):
        #{`git log --pretty=oneline -1`}
    EOD
    elpa.commit_all_packages
    exit 0
  end

end

option_parser.parse!

puts option_parser


